<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Java 9</title>

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/simple.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>
        <style type="text/css">
            .references {
                position: absolute;
                left: 0px;
                bottom: -20px;
                font-size: 15px !important;
                text-align: left;
            }
        </style>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">

                <section>
                    <section>
                        <h1>What's new in Java 9</h1>
                    </section>
                    <section>
                        <h2>Michal Vala</h2>
                        <ul>
                            <li>Software developer (Java)</li>
                            <li>OpenJDK Quality Enginner @ Red Hat</li>
                            <li><a href="https://plus.google.com/+MichalVala">plus.google.com/+MichalVala</a></li>
                            <li><a href="https://twitter.com/___Michal___">twitter.com/___Michal___</a></li>
                            <li><a href="https://github.com/sparkoo">github.com/sparkoo</a></li>
                            <li><a href="https://sparkoo.github.io/">sparkoo.github.io</a></li>
                        </ul>
                    </section>
                </section>

                <section>
                    <section>
                        <h1>Java</h1>
                        <aside class="notes">
                            <ul>
                                <li>Raise hands:</li>
                                <li>How many java developers?</li>
                                <li>Familiar with Java 8?</li>
                                <li>Tried Java9?</li>
                            </ul>
                        </aside>
                    </section>
                    <section>
                        <h2>Java 8 ?</h2>
                        <h4 class="fragment">Lambda</h4>
                        <div class="references">
                            <a href="http://openjdk.java.net/projects/jdk8/">http://openjdk.java.net/projects/jdk8/</a>
                        </div>
                        <aside class="notes">
                            What was Java 8 about? Key feature. Lambdas and stream API.
                        </aside>
                    </section>
                    <section>
                        <h2>Java 9 ?</h2>
                        <h4 class="fragment">Modules - Project Jigsaw</h4>
                        <ul>
                            <li class="fragment">new tools</li>
                            <li class="fragment">new APIs</li>
                            <li class="fragment">language changes</li>
                            <li class="fragment">internal changes</li>
                            <li class="fragment">removals, deprecations</li>
                            <li class="fragment">...</li>
                        </ul>
                        <div class="references">
                            <a href="http://openjdk.java.net/projects/jdk9/">http://openjdk.java.net/projects/jdk9/</a>
                        </div>
                        <aside class="notes">
                            Java 9 is about modules. But not just modules...
                        </aside>
                    </section>
                    <section>
                        <h2>Java 9 current state</h2>
                        <ul>
                            <li>in <strong>Rampdown</strong> phase</li>
                            <li>GA 27th July 2017</li>
                        </ul>
                        <div class="references">
                            <a href="http://openjdk.java.net/projects/jdk9/">http://openjdk.java.net/projects/jdk9/</a>
                        </div>
                        <aside class="notes">
                            <ul>
                                <li>Rampdown - all features in, available for developers, just P1-P3 bugfixes. New features in very rare cases.</li>
                                <li>Postponed 2 times, from September 2016</li>
                            </ul>
                        </aside>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Version-String scheme</h2>
                        <p>
                            <span>8u74</span> ->
                            <span class="fragment">8u77 -> </span>
                            <span class="fragment">8u91 -> </span>
                            <span class="fragment">8u92 -> </span>
                            <span class="fragment">8u101 -> ...</span>
                        </p>
                        <p class="fragment">
                            long version - 1.8.0_101-b14
                        </p>
                        <div class="references">
                        	<a href="http://www.oracle.com/technetwork/java/javase/overview/jdk-version-number-scheme-1918258.html">http://www.oracle.com/technetwork/java/javase/overview/jdk-version-number-scheme-1918258.html</a><br />
                            <a href="http://openjdk.java.net/jeps/223">JEP 223: New Version-String Scheme</a>
                        </div>
                        <aside class="notes">
                            <ul>
                                <li>Let's look to some java 8 versions in order.</li>
                                <li>Doesn't make much sense, but we might be happy it's at least in ascending order.</li>
                                <li>That's short version which is better than long version.</li>
                                <li>For 20 years it's 1.something and it looks like version 2 will never happen.</li>
                                <li>Problem is that 1.8.0 holds just one information - java 8.</li>
                                <li>But 101 holds 2 information - security and minor update</li>
                            </ul>
                        </aside>
                    </section>
                    <section data-background="http://i.giphy.com/aZ3LDBs1ExsE8.gif">
                    </section>
                    <section>
                        <h2>Java 9</h2>
                        <p>
                            <ul>
                                <li>no 1.9.0_...</li>
                                <li>no two things in one number</li>
                                <li>$MAJOR.$MINOR.$SECURITY<+$BUILD></li>
                                <li><a href="http://download.java.net/java/jdk9/docs/api/java/lang/Runtime.Version.html">Runtime.Version</a></li>
                            </ul>
                        </p>
                        <p>
                            <span class="fragment">9 -> </span>
                            <span class="fragment">9.0.1 -> </span>
                            <span class="fragment">9.0.2 -> </span>
                            <span class="fragment">9.1.2 -> </span>
                            <span class="fragment">9.1.3 -> ...</span>
                        </p>
                        <div class="references">
                            <a href="http://openjdk.java.net/jeps/223">JEP 223: New Version-String Scheme</a>
                        </div>
                    </section>
                </section>

                <section>
                    <h2>Garbage-First (G1)</h2>
                    <ul>
                        <li class="fragment">since Java 7</li>
                        <li class="fragment">default Garbage Collector in Java 9</li>
                        <li class="fragment">minimize pauses</li>
                    </ul>
                    <div class="references">
                        <a href="http://openjdk.java.net/jeps/248">JEP 248: Make G1 the Default Garbage Collector</a>
                    </div>
                    <aside class="notes">
                        <ul>
                            <li>G1 is available since 7.</li>
                            <li>Enhanced several times so in Java 9 it will become default garbage collector.</li>
                            <li>Current default is Parallel collector (Serial for single core).</li>
                            <li>Parallel - oriented to maximize throughput</li>
                            <li>G1 - oriented to minimize pauses</li>
                        </ul>
                    </aside>
                </section>
                <section>
                    <h2>@Deprecated</h2>
                    <ul>
                        <li>
                            2 new elements
                            <ul>
                                <li>since : String</li>
                                <li>forRemoval : boolean</li>
                            </ul>
                        </li>
                        <li>will help remove old API from jdk ?</li>
                        <li>jdeprscan [demo]</li>
                    </ul>
                    <div class="references">
                        <a href="http://openjdk.java.net/jeps/277">JEP 277: Enhanced Deprecation</a>
                    </div>
                    <aside class="notes">
                        <ul>
                            <li>since - tells from which version is api marked as deprecated</li>
                            <li>forRemoval - will be removed in next major release (jdk9)</li>
                        </ul>
                    </aside>
                </section>

                <section>
                    <section>
                        <h2>JShell</h2>
                        <p>Read Eval Print Loop (REPL)</p>
                        <p class="fragment">but why?</p>
                        <ul>
                            <li class="fragment">learn/teach</li>
                            <li class="fragment">microtesting</li>
                            <li class="fragment">API -> new tools</li>
                        </ul>
                        <div class="references">
                            <a href="http://openjdk.java.net/jeps/222">JEP 222: jshell: The Java Shell (Read-Eval-Print Loop)</a>
                        </div>
                        <aside class="notes">
                            <ul>
                                <li>JShell is one of new tools in bin directory.</li>
                                <li>Many languages has REPL (lisp from 1958, python), even jvm languages like Scala, Clojure</li>
                                <li>For 20 years we lived without REPL in java. Why would we want it?</li>
                                <li>Learn or teach someone. Show how java looks like. It might be really verbose for newcomers to start with java class.</li>
                                <li>Microtesting - try some small part of code without writing unit test.</li>
                                <li>Jshell has API so it opens door for new tools (for example to IDE).</li>
                            </ul>
                        </aside>
                    </section>
                    <section>
                        <h2>JShell API</h2>
                        <pre><code class="java hljs">
try (JShell jShell = JShell.create()) {
    jShell.eval("int a = 5;");
    jShell.eval("int b = 6;");
    jShell.eval("int c = a + b;");
    jShell.variables().forEach(
        v -> log(v.name() + " = " + jShell.varValue(v)));
}
                        </code></pre>
                        <pre class="fragment"><code class="java hljs">
a = 5
b = 6
c = 11
                        </code></pre>
                    </section>
                    <section>
                        <h2>JShell [demo]</h2>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Small language changes</h2>
                        <ul>
                            <li>Project Coin</li>
                            <li class="fragment">@SafeVargs on private instance methods</li>
                            <li class="fragment">effectively-final variables in try-with-resources</li>
                            <li class="fragment">diamond with anonymous class</li>
                            <li class="fragment">'_' no longer valid identifier</li>
                            <li class="fragment">private methods in interfaces</li>
                        </ul>
                        <div class="references">
                            <a href="http://openjdk.java.net/jeps/213">JEP 213: Milling Project Coin</a><br />
                            <a href="http://openjdk.java.net/projects/coin/">Project Coin</a>
                        </div>
                        <aside class="notes">
                            <ul>
                                <li>Project coin is project for small language changes (strings in switch, diamond, multi-catch, ...)</li>
                                <li>@SafeVargs annotation for programmers. By definition could be on final elements, which private methods are. In java 8 it was not possible</li>
                                <li>try with resources show example</li>
                                <li>diamond example</li>
                                <li>_ warning in java 8, now error</li>
                                <li>Default methods in interfaces from java 8. now private methods to support them.</li>
                            </ul>
                        </aside>
                    </section>

                    <section>
                        <h2>try-with-resources</h2>
                        Java 8
                        <pre><code class="java hljs">
try (SomeCloseableClass s = new SomeCloseableClass()) {
    ...
}
                        </code></pre>
                    </section>

                    <section>
                        <h2>try-with-resources</h2>
                        Java 9
                        <pre><code class="java hljs">
SomeCloseableClass s = new SomeCloseableClass();
try (s) {
    ...
}
                        </code></pre>
                        <pre><code class="java hljs">
void method(AutoCloseable s) {
    try (s) {
        ...
    }
}
                        </code></pre>
                        <aside class="notes">
                            as long as variable is final or effectivly final, can use without declaration
                        </aside>
                    </section>

                    <section>
                        <h2>&lt;&gt; with anonymous class</h2>
                        Java 8
                        <pre><code class="java hljs">
Iface&lt;String&gt; anonymous = new Iface&lt;String&gt;() {
    ...
};
                        </code></pre>
                        Java 9
                        <pre><code class="java hljs">
Iface&lt;String&gt; anonymous = new Iface&lt;&gt;() {
    ...
};
                        </code></pre>
                        <aside class="notes">
                            <ul>
                                <li>When type is clear, you don't have to write it explicitly.</li>
                            </ul>
                        </aside>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>new APIs</h2>
                        <ul>
                            <li>HTTP/2 Client</li>
                            <li>Process API</li>
                            <li>List/Map/Set - factory methods</li>
                            <li>Stream - new methods</li>
                            <li>Optional - new methods</li>
                            <li>...</li>
                        </ul>
                        <div class="references">
                            <a href="http://openjdk.java.net/jeps/110">JEP 110: HTTP/2 Client (Incubator)</a><br />
                            <a href="http://openjdk.java.net/jeps/102">JEP 102: Process API Updates</a><br />
                            <a href="http://openjdk.java.net/jeps/269">JEP 269: Convenience Factory Methods for Collections</a>
                        </div>
                    </section>

                    <section>
                        <h2>GET request in Java</h2>
                        <pre><code class="java hljs">
StringBuilder result = new StringBuilder();
URL url = new URL("http://...");
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
conn.setRequestMethod("GET");
BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
String line;
while ((line = rd.readLine()) != null) {
 result.append(line);
}
rd.close();
return result.toString();
</code></pre>
                        <div class="references">
                            <a href="http://stackoverflow.com/a/1485730">http://stackoverflow.com/a/1485730</a>
                        </div>
                        <aside class="notes">
                            <ul>
                                <li>from stackowerflow</li>
                            </ul>
                        </aside>
                    </section>

                    <section>
                        <h2>GET with HTTP/2 Client</h2>
                        <pre><code class="java hljs">
HttpClient client = HttpClient.newHttpClient();
HttpRequest request = HttpRequest.newBuilder()
        .uri(new URI("http://..."))
        .GET()
        .build();

HttpResponse&lt;String&gt; response =
    client.send(request, HttpResponse.BodyHandler.asString());
return response.body();
</pre></code>
                        <p>[demo]</p>
                        <p class="fragment">unfortunately in incubator</p>
                        <div class="references">
                            <a href="http://openjdk.java.net/jeps/110">JEP 110: HTTP/2 Client (Incubator)</a><br />
                        </div>
                    </section>

                    <section>
                        <h2>Process API (old way)</h2>
                        How get all running processes?
                        <pre><code class="java hljs">
String line;
Process p = Runtime.getRuntime().exec("ps -e");
BufferedReader input =
        new BufferedReader(new InputStreamReader(p.getInputStream()));
while ((line = input.readLine()) != null) {
    System.out.println(line); //<-- Parse data here.
}
input.close();
                        </code></pre>
                        <div class="references">
                            <a href="http://stackoverflow.com/a/54950">http://stackoverflow.com/a/54950</a>
                        </div>
                    </section>

                    <section>
                        <h2>Process API</h2>
                        <pre><code class="java hljs">
ProcessHandle.allProcesses()    // returns Stream&lt;ProcessHandle&gt;
                        </code></pre>
                        [demo?]
                        <div class="references">
                            <a href="http://download.java.net/java/jdk9/docs/api/java/lang/ProcessHandle.html">ProcessHandle javadoc</a>
                        </div>
                    </section>

                    <section>
                        <h2>List/Map/Set - factory methods</h2>
                        <pre><code class="java hljs">
List&lt;Integer&gt; list = List.of(1, 2, 3, 4, 5);
Set&lt;Integer&gt; set = Set.of(1, 2, 3, 4, 5);
Map&lt;Integer, Integer&gt; map = Map.of(1, 11, 2, 22, 3, 33, 4, 44);
Map&lt;Integer, Integer&gt; map2 = Map.ofEntries(
    Map.entry(1, 11),
    Map.entry(2, 22),
    Map.entry(3, 33),
    Map.entry(4, 44));
                        </code></pre>
                        <div class="references">
                        <a href="http://download.java.net/java/jdk9/docs/api/java/util/List.html">List javadoc</a><br />
                        <a href="http://download.java.net/java/jdk9/docs/api/java/util/Map.html">Map javadoc</a><br />
                        <a href="http://download.java.net/java/jdk9/docs/api/java/util/Set.html">Set javadoc</a>
                        </div>
                    </section>

                    <section>
                        <h2>New methods is Stream</h2>
                        <pre><code class="java hljs">
static &lt;T&gt; Stream&lt;T&gt; iterate(T seed,
    Predicate&lt;? super T&gt; hasNext,
    UnaryOperator&lt;T&gt; next)
default Stream&lt;T&gt; dropWhile(Predicate&lt;? super T&gt; predicate)
default Stream&lt;T&gt; takeWhile(Predicate&lt;? super T&gt; predicate)
                        </code></pre>
                        [demo]
                        <div class="references">
                            <a href="http://download.java.net/java/jdk9/docs/api/java/util/stream/Stream.html">Stream javadoc</a>
                        </div>
                        <aside class="notes">
                            JShell demo
                        </aside>
                    </section>

                    <section>
                        <h2>New methods in Optional</h2>
                        <pre><code class="java hljs">
public void ifPresentOrElse(Consumer&lt;? super T&gt; action,
    Runnable emptyAction)
                        </code></pre>
                        <pre class="fragment"><code class="java hljs">
optional.ifPresentOrElse(val -> ...,
    () -> log("got nothing"));
                        </code></pre>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Modules</h2>
                        <ul>
                            <li class="fragment">Project Jigsaw</li>
                            <li class="fragment">Goals
                                <ul>
                                    <li class="fragment">strong encapsulation</li>
                                    <li class="fragment">scalability (down)</li>
                                    <li class="fragment">reliable configuration</li>
                                </ul>
                            </li>
                            <li class="fragment">2 layers
                                <ul>
                                    <li class="fragment">modularize JDK itself</li>
                                    <li class="fragment">same module system for your app</li>
                                </ul>
                            </li>
                        </ul>
                        <div class="references">
                            <a href="http://openjdk.java.net/projects/jigsaw/">Project Jigsaw</a>
                        </div>
                        <aside class="notes">
                            <ul>
                                <li>Jigsaw
                                    <ul>
                                        <li>Module system is developed under project jigsaw.</li>
                                        <li>Originally was planned to Java 8, but moved to Java 9.</li>
                                        <li>Reason of Java 9 postpones.</li>
                                        <li>Development started in 2009 - JDK7 in development</li>
                                    </ul>
                                </li>
                                <li>Encapsulation - I can say what to export from my module, rest is hidden. I can define API.</li>
                                <li>Scalability down, to smaller units. Useful for IOT.</li>
                                <li>Solve issues with classpath and jar hell. It's clear what I'm using.</li>
                                <li>operates on 2 layers</li>
                            </ul>
                        </aside>
                    </section>

                    <section>
                        <table summary="This table defines levels of access conferred by a modifier">
                            <caption style="font-weight: bold">Access Levels</caption>
                            <tbody>
                                <tr>
                                    <th>Modifier</th>
                                    <th>Class</th>
                                    <th>Package</th>
                                    <th>Subclass</th>
                                    <th>World</th>
                                </tr>
                                <tr>
                                    <td><code>public</code></td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                </tr>
                                <tr>
                                    <td><code>protected</code></td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>N</td>
                                </tr>
                                <tr>
                                    <td style="font-style: italic">no modifier</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>N</td>
                                    <td>N</td>
                                </tr>
                                <tr>
                                    <td><code>private</code></td>
                                    <td>Y</td>
                                    <td>N</td>
                                    <td>N</td>
                                    <td>N</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="references">
                            <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html">Controlling Access to Members of a Class</a>
                        </div>
                        <aside class="notes">
                            <ul>
                                <li>Jigsaw fix this table.</li>
                                <li>Private - ok, just in class</li>
                                <li>Default - ok, just in package</li>
                                <li>Protected - ok, subclasses</li>
                                <li>Public - World, too much. Big step</li>
                            </ul>
                        </aside>
                    </section>
                    <section>
                        <table summary="This table defines levels of access conferred by a modifier">
                            <tbody>
                                <tr>
                                    <th>Modifier</th>
                                    <th>Class</th>
                                    <th>Package</th>
                                    <th>Subclass</th>
                                    <th>Module</th>
                                    <th>World</th>
                                </tr>
                                <tr>
                                    <td><code>"exports"</code></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td>Y</td>
                                </tr>
                                <tr>
                                    <td><code>public</code></td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>N</td>
                                </tr>
                                <tr>
                                    <td><code>protected</code></td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>N</td>
                                    <td>N</td>
                                </tr>
                                <tr>
                                    <td style="font-style: italic">no modifier</td>
                                    <td>Y</td>
                                    <td>Y</td>
                                    <td>N</td>
                                    <td>N</td>
                                    <td>N</td>
                                </tr>
                                <tr>
                                    <td><code>private</code></td>
                                    <td>Y</td>
                                    <td>N</td>
                                    <td>N</td>
                                    <td>N</td>
                                    <td>N</td>
                                </tr>
                            </tbody>
                        </table>
                        <aside class="notes">
                            <ul>
                                <li>I would fix this table like this.</li>
                                <li>Public is no longer visible to world, but only to module.</li>
                                <li>I have to explicitly export to be visible to world.</li>
                            </ul>
                        </aside>
                    </section>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                history: true,
                slideNumber: true,
                mouseWheel: true,
                transition: 'slide',
                //parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
                //parallaxBackgroundHorizontal: 1000,
                //parallaxBackgroundVertical: 20,

                // More info https://github.com/hakimel/reveal.js#dependencies
                dependencies: [
                    { src: 'plugin/markdown/marked.js' },
                    { src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
        </script>
    </body>
</html>
